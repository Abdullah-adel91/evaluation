<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø©</title>

<style>
body{direction:rtl;font-family:Arial;background:#f4f4f4;padding:10px}
.item{background:#fff;margin:6px 0;padding:10px;border-radius:8px}
button{margin:3px;padding:8px 14px;font-size:16px}
.result{font-weight:bold;font-size:18px;margin-right:8px}
.hidden{display:none}
.alert{color:red;text-align:center;margin:10px}
select{padding:6px 12px;font-size:16px;margin-bottom:10px}
h3{text-align:center;margin-bottom:10px}
</style>
</head>

<body>

<h3>ğŸ“ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª</h3>

<!-- Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆØ¸Ù -->
<label>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù:</label>
<select id="employeeSelect"></select>
<button onclick="openNameEditor()">âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡</button>
<br><br>

<div id="items"></div>

<div id="msg" class="alert hidden">âš ï¸ Ù‚ÙŠÙ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ù†ÙˆØ¯ Ù‚Ø¨Ù„ Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡</div>

<br>
<button onclick="saveEvaluation()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</button>
<button onclick="showErrors()">â— Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡</button>
<button onclick="resetCurrentEmployee()">ğŸ”„ Ø§Ù„Ø¨Ø¯Ø¡ Ù…Ù† Ø¬Ø¯ÙŠØ¯</button>

<hr>
<button onclick="downloadExcel()">â¬‡ï¸ ØªØ­Ù…ÙŠÙ„ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ø´Ù‡Ø±</button>
<button onclick="resetAllData()">ğŸ—‘ï¸ Ø­Ø°Ù ÙƒÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ù‡Ø±</button>
<button onclick="deleteEverything()">ğŸ”¥ Ø­Ø°Ù Ø´Ø§Ù…Ù„ + Ø§Ù„Ø£Ø³Ù…Ø§Ø¡</button>

<hr>

<!-- Ù†Ø§ÙØ°Ø© ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ -->
<div id="nameEditor" class="hidden" style="background:#fff;padding:20px;border-radius:10px;">
<h3>ØªØ¹Ø¯ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ù…Ø§Ø¡</h3>
<input id="newName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø¬Ø¯ÙŠØ¯">
<button onclick="addName()">â• Ø¥Ø¶Ø§ÙØ©</button>
<ul id="nameList"></ul>
<button onclick="closeNameEditor()">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<script>
// =================== Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ===================
const evaluationItems = [
 "ØªØ±Ø­ÙŠØ¨ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ù‡ Ùˆ Ø°ÙƒØ± Ø§Ù„Ø§Ø³Ù…",
 "Ø·Ù„Ø¨ Ø§Ø³Ù… Ø§Ù„Ù…Ø´ØªØ±Ùƒ Ùˆ Ø°ÙƒØ±Ù‡ Ù…Ø±Ù‡ ÙˆØ§Ø­Ø¯Ù‡",
 "Ø§Ø®Ø° Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨",
 "Ù…Ø·Ø§Ø¨Ù‚Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨",
 "Ø§Ø®Ø° Ø§Ø°Ù† Ø§Ù„Ù…Ø´ØªØ±Ùƒ Ù‚Ø¨Ù„ ÙˆØ¶Ø¹Ù‡ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±",
 "Ø§Ø¯Ø§Ø±Ø© ÙˆÙ‚Øª Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ù‡",
 "Ø§Ù„ØªØ³ÙˆÙŠÙ‚ Ù„ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ø¹Ø¯Ø§Ø¯",
 "ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ù‡",
 "Ø§Ù†Ù‡Ø§Ø¡ ØµØ­ÙŠØ­ Ù„Ù„Ù…ÙƒØ§Ù„Ù…Ø©",
 "Ù‡Ù„ Ø§Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø© ØµØ­ÙŠØ­"
];

let employees = JSON.parse(localStorage.getItem("employees") || "[]");
let evaluations = JSON.parse(localStorage.getItem("evaluations") || "{}");

// =================== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† ===================
function loadEmployees(){
 const sel=document.getElementById("employeeSelect");
 sel.innerHTML="";
 employees.forEach(e=>{
   const op=document.createElement("option");
   op.value=e; op.textContent=e;
   sel.appendChild(op);
 });
 if(employees.length===0) employees=["Ù…ÙˆØ¸Ù 1"];
 localStorage.setItem("employees",JSON.stringify(employees));
 loadItems();
}

function loadItems(){
 const emp=document.getElementById("employeeSelect").value;
 const container=document.getElementById("items");
 container.innerHTML="";
 evaluationItems.forEach((txt,i)=>{
   const saved = evaluations[emp] ? evaluations[emp][i] : "";
   container.innerHTML+=`
   <div class="item">${txt}
   <br><button onclick="setValue(${i},'âœ”ï¸')">âœ”ï¸</button>
   <button onclick="setValue(${i},'âœ–ï¸')">âœ–ï¸</button>
   <span class="result">${saved}</span></div>`;
 });
}

function setValue(i,val){
 const emp=document.getElementById("employeeSelect").value;
 if(!evaluations[emp]) evaluations[emp]=[];
 evaluations[emp][i]=val;
 localStorage.setItem("evaluations",JSON.stringify(evaluations));
 loadItems();
}

// =================== Ø­ÙØ¸ â€” Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ â€” Ø­Ø°Ù ===================
function saveEvaluation(){
 alert("âœ”ï¸ ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆØ¸Ù");
}

function showErrors(){
 const emp=document.getElementById("employeeSelect").value;
 const all=evaluations[emp];
 if(!all || all.length!==evaluationItems.length || all.includes("")){
   document.getElementById("msg").classList.remove("hidden");
   return;
 }
 document.getElementById("msg").classList.add("hidden");
 document.querySelectorAll('.item').forEach((div,i)=>{
   div.style.display = (evaluations[emp][i]==="âœ–ï¸") ? "block" : "none";
 });
}

function resetCurrentEmployee(){
 const emp=document.getElementById("employeeSelect").value;
 delete evaluations[emp];
 localStorage.setItem("evaluations",JSON.stringify(evaluations));
 loadItems();
 alert("ğŸ”„ ØªÙ… Ø§Ù„Ø¨Ø¯Ø¡ Ù…Ù† Ø¬Ø¯ÙŠØ¯ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆØ¸Ù ÙÙ‚Ø·");
}

function resetAllData(){
 evaluations={};
 localStorage.setItem("evaluations","{}");
 alert("ğŸ—‘ï¸ ØªÙ… Ø­Ø°Ù Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ù‡Ø± â€” Ø§Ø¨Ø¯Ø£ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©");
 loadItems();
}

function deleteEverything(){
 localStorage.clear();
 employees=[];
 evaluations={};
 alert("ğŸ”¥ ØªÙ… Ø­Ø°Ù ÙƒÙ„ Ø´ÙŠØ¡ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ + Ø§Ù„Ø£Ø³Ù…Ø§Ø¡");
 location.reload();
}

// =================== ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ ===================
function openNameEditor(){
 document.getElementById("nameEditor").classList.remove("hidden");
 updateNameList();
}
function closeNameEditor(){
 document.getElementById("nameEditor").classList.add("hidden");
 loadEmployees();
}
function addName(){
 const name=document.getElementById("newName").value.trim();
 if(name==="")return;
 employees.push(name);
 localStorage.setItem("employees",JSON.stringify(employees));
 document.getElementById("newName").value="";
 updateNameList();
 loadEmployees();
}
function removeName(n){
 employees=employees.filter(e=>e!==n);
 delete evaluations[n];
 localStorage.setItem("employees",JSON.stringify(employees));
 localStorage.setItem("evaluations",JSON.stringify(evaluations));
 updateNameList();
 loadEmployees();
}
function updateNameList(){
 const ul=document.getElementById("nameList");
 ul.innerHTML="";
 employees.forEach(n=>{
   ul.innerHTML+=`<li>${n} <button onclick="removeName('${n}')">âŒ Ø­Ø°Ù</button></li>`;
 });
}

// =================== Excel ===================
function downloadExcel(){
 const rows=[["Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù",...evaluationItems]];
 for(const emp of employees){
   const row=[emp];
   const evals=evaluations[emp]||[];
   evaluationItems.forEach((_,i)=>row.push(evals[i]||""));
   rows.push(row);
 }
 const content=rows.map(r=>r.join(",")).join("\n");
 const blob=new Blob([content],{type:"text/csv;charset=utf-8;"});
 const link=document.createElement("a");
 link.href=URL.createObjectURL(blob);
 link.download="ØªÙ‚Ø±ÙŠØ±_Ø§Ù„Ø´Ù‡Ø±.csv";
 link.click();
}

loadEmployees();
</script>

</body>
</html>
