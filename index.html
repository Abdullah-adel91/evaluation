<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª</title>

<!-- Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø¥ÙƒØ³Ù„ -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<style>
body {
    font-family: Tahoma, sans-serif;
    background: #f6f6f6;
    margin: 20px;
    line-height: 1.8;
}

.container {
    background: #fff;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 5px #ddd;
    max-width: 700px;
    margin: auto;
}

button, select, input, textarea {
    font-size: 18px;
    padding: 10px;
    margin: 5px 0;
    width: 100%;
}

.buttons-row {
    display: flex;
    gap: 10px;
    margin-top: 10px;
}

.buttons-row button {
    flex: 1;
}

h3 {
    margin-top: 30px;
    border-bottom: 1px solid #ddd;
    padding-bottom: 8px;
}
</style>
</head>
<body>
<div class="container">

<h2>ğŸ“ Ù†Ø¸Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠ</h2>

<!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ -->
<h3>Ø¥Ø¯Ø§Ø±Ø© Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</h3>
<select id="employeeSelect"></select>
<div class="buttons-row">
    <input type="text" id="newName" placeholder="Ø§Ø³Ù… Ù…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯">
    <button onclick="addName()">â• Ø¥Ø¶Ø§ÙØ©</button>
</div>
<button onclick="removeName()">âŒ Ø­Ø°Ù Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ø¯Ø¯</button>

<!-- Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… -->
<h3>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</h3>
<input type="date" id="dateInput">
<input type="text" id="criteriaInput" placeholder="Ø§Ù„Ù…Ø¹ÙŠØ§Ø±">
<input type="number" id="scoreInput" placeholder="Ø§Ù„ØªÙ‚ÙŠÙŠÙ… /10">
<textarea id="notesInput" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª"></textarea>
<button onclick="saveEvaluation()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</button>

<!-- Ù…Ø¹Ø§Ù„Ø¬Ø© -->
<h3>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</h3>
<div class="buttons-row">
    <button onclick="filterErrors()">ğŸ” Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ÙÙ‚Ø·</button>
    <button onclick="resetFilters()">ğŸ”„ Ø§Ù„Ø¨Ø¯Ø¡ Ù…Ù† Ø¬Ø¯ÙŠØ¯</button>
</div>

<div class="buttons-row">
    <button onclick="downloadExcel()">ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ø¥ÙƒØ³Ù„</button>
    <button onclick="clearAll()">ğŸ—‘ï¸ Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ¨Ø¯Ø§ÙŠØ© Ø´Ù‡Ø± Ø¬Ø¯ÙŠØ¯</button>
</div>

<h3>ğŸ“Œ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</h3>
<div id="list"></div>

</div>

<script>
// ------------------ ØªØ®Ø²ÙŠÙ† Ù…Ø­Ù„ÙŠ ---------------------
let employees = JSON.parse(localStorage.getItem("employees")) || ["Ù…Ø­Ù…Ø¯", "Ø³Ø§Ø±Ø©"];
let evaluations = JSON.parse(localStorage.getItem("evaluations")) || [];

// ------------------ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ ---------------------
function updateEmployeeSelect() {
    let sel = document.getElementById("employeeSelect");
    sel.innerHTML = "";
    employees.forEach(n => {
        let o = document.createElement("option");
        o.value = n; o.textContent = n;
        sel.appendChild(o);
    });
}
updateEmployeeSelect();
renderEvaluations();

// ------------------ Ø¥Ø¶Ø§ÙØ© Ø§Ø³Ù… ---------------------
function addName(){
    const n = document.getElementById("newName").value.trim();
    if(!n) return alert("Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø£ÙˆÙ„");
    employees.push(n);
    localStorage.setItem("employees", JSON.stringify(employees));
    document.getElementById("newName").value="";
    updateEmployeeSelect();
}

// ------------------ Ø­Ø°Ù Ø§Ù„Ø§Ø³Ù… ---------------------
function removeName(){
    const sel = document.getElementById("employeeSelect").value;
    employees = employees.filter(n => n !== sel);
    localStorage.setItem("employees", JSON.stringify(employees));
    updateEmployeeSelect();
}

// ------------------ Ø­ÙØ¸ ØªÙ‚ÙŠÙŠÙ… ---------------------
function saveEvaluation(){
    let obj = {
        name: document.getElementById("employeeSelect").value,
        date: document.getElementById("dateInput").value,
        criteria: document.getElementById("criteriaInput").value,
        score: document.getElementById("scoreInput").value,
        notes: document.getElementById("notesInput").value
    };

    evaluations.push(obj);
    localStorage.setItem("evaluations", JSON.stringify(evaluations));
    renderEvaluations();
    alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…");
}

// ------------------ Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª ---------------------
function renderEvaluations(list = evaluations){
    let div = document.getElementById("list");
    if(list.length === 0){ div.innerHTML="Ù…Ø§ÙÙŠ Ø¨ÙŠØ§Ù†Ø§Øª"; return; }

    div.innerHTML = list.map(e =>
        `<div style="border-bottom:1px solid #ddd;padding:6px">
            <b>${e.name}</b> | ${e.date} | ${e.criteria} | â­${e.score}/10
            <br> Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${e.notes}
        </div>`
    ).join("");
}

// ------------------ ØªØµÙÙŠØ© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ (Ø£Ù‚Ù„ Ù…Ù† 8 Ù…Ø«Ø§Ù„) ---------------------
function filterErrors(){
    let filtered = evaluations.filter(e => e.score < 8);
    renderEvaluations(filtered);
}

// ------------------ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØµÙÙŠØ© ---------------------
function resetFilters(){ renderEvaluations(); }

// ------------------ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥ÙƒØ³Ù„ ---------------------
function downloadExcel(){
    if(evaluations.length === 0) return alert("Ù…Ø§ÙÙŠ Ø¨ÙŠØ§Ù†Ø§Øª");

    const rows = [["Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù","Ø§Ù„ØªØ§Ø±ÙŠØ®","Ø§Ù„Ù…Ø¹ÙŠØ§Ø±","Ø§Ù„ØªÙ‚ÙŠÙŠÙ…","Ù…Ù„Ø§Ø­Ø¸Ø§Øª"]];
    evaluations.forEach(e => rows.push([e.name,e.date,e.criteria,e.score,e.notes]));

    const ws = XLSX.utils.aoa_to_sheet(rows);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Ø§Ù„Ø´Ù‡Ø±");

    XLSX.writeFile(wb, "ØªÙ‚ÙŠÙŠÙ…Ø§Øª_Ø§Ù„Ø´Ù‡Ø±.xlsx");
}

// ------------------ Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ---------------------
function clearAll(){
    if(confirm("Ù‡Ù„ Ø§Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ Ø³ÙŠØªÙ… Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª ÙˆØ¨Ø¯Ø¡ Ø´Ù‡Ø± Ø¬Ø¯ÙŠØ¯")){
        evaluations = [];
        localStorage.setItem("evaluations", JSON.stringify(evaluations));
        renderEvaluations();
        alert("ØªÙ… Ø­Ø°Ù ÙƒÙ„ Ø´ÙŠØ¡ ÙˆØ¨Ø¯Ø¡ Ø´Ù‡Ø± Ø¬Ø¯ÙŠØ¯");
    }
}
</script>
</body>
</html>
